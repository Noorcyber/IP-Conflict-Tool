#!/bin/bash

display_datto_netrunners() {
    cat << "EOF"
██╗██████╗ ██████╗ ███████╗ ██████╗ ██████╗ ███╗   ██╗
██║██╔══██╗██╔══██╗██╔════╝██╔════╝██╔═══██╗████╗  ██║
██║██████╔╝██████╔╝█████╗  ██║     ██║   ██║██╔██╗ ██║
██║██╔═══╝ ██╔══██╗██╔══╝  ██║     ██║   ██║██║╚██╗██║
██║██║     ██║  ██║███████╗╚██████╗╚██████╔╝██║ ╚████║
╚═╝╚═╝     ╚═╝  ╚═╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝

  By Noor Shaheed, Datto, Kaseya. 05/27/2024 Ip Conflict tool V.01
EOF
}

display_datto_netrunners

echo "Fetching ARP table..."
arp_output=$(ip neigh)

echo "ARP table output:"
echo "$arp_output"

echo "Analyzing ARP table for IP conflicts..."

conflicts=$(echo "$arp_output" | awk '{print $5}' | sort | uniq -d)

echo "Potential conflict MACs:"
echo "$conflicts"

if [ -n "$conflicts" ]; then
    echo "IP conflicts detected (MACs responding to multiple IPs):"
    echo "$conflicts"
else
    echo "No IP conflicts detected."
fi

echo "Checking for IP conflict logs..."
logread 2>/dev/null | grep -i conflict || echo "No conflict logs found."
